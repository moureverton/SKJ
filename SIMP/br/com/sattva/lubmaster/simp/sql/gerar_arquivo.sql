SELECT
  ROWNUM,
  COALESCE(CODEMP_ANP,'0') AS CODEMP_ANP,
  COALESCE(MESREFERENCIA,'0') AS MESREFERENCIA,
  COALESCE((SELECT OPER.CODOPER_ANP FROM AD_OPERACAOANP OPER WHERE OPER.CODOPER = A.CODOPER),'0') AS CODOPERACAO,
  COALESCE(CODINSTALACAO1,'0') AS CODINSTALACAO1,
  COALESCE(CODINSTALACAO2,'0') AS CODINSTALACAO2,
  COALESCE(CODPROD_ANP,'0') AS CODPROD_ANP,
  COALESCE(QTD_PROD_UN_ANP,'0') AS QTD_PROD_UN_ANP,
  COALESCE(QTD_PROD_OPERADO_KG,'0') AS QTD_PROD_OPERADO_KG,
  COALESCE(COD_MODAL_MOVIMENTACAO,'0') AS COD_MODAL_MOVIMENTACAO,
  COALESCE(COD_OLEODUTO_TRANSPORTE,'0') AS COD_OLEODUTO_TRANSPORTE,
  COALESCE(CNPJ_PARC,'0') AS CNPJ_PARC,
  COALESCE(CODCID_ANP,'0') AS CODCID_ANP,
  COALESCE(COD_ATIV_PARC_ANP,'0') AS COD_ATIV_PARC_ANP,
  COALESCE(CODPAIS_ANP,'0') AS CODPAIS_ANP,
  COALESCE(NUM_LICEN_IMPORT,'0') AS NUM_LICEN_IMPORT,
  COALESCE(NUM_DECLARACAO_IMPORT,'0') AS NUM_DECLARACAO_IMPORT,
  COALESCE(NUMNF,'0') AS NUMNF,
  COALESCE(SERIE_NF,'0') AS SERIE_NF,
  COALESCE(DAT_OPER_COMERCIAL,'0') AS DAT_OPER_COMERCIAL,
  COALESCE(COD_TIP_TARIFA_SERVICO,'0') AS COD_TIP_TARIFA_SERVICO,
  COALESCE(CARACTERISTICA,'0') AS CARACTERISTICA,
  COALESCE(METODO,'0') AS METODO,
  COALESCE(MODALIDADE_FRETE,'0') AS MODALIDADE_FRETE,
  COALESCE(NUM_DOC_QUALIDADE,'0') AS NUM_DOC_QUALIDADE,
  COALESCE(COD_OPER_RESULTANTE,'0') AS COD_OPER_RESULTANTE,
  COALESCE(VLRUNIT_NF,'0') AS VLRUNIT_NF,
  COALESCE(RECEPIENTE_GLP,'0') AS RECEPIENTE_GLP,
  COALESCE(CAHVE_NFE_CTE,'0') AS CAHVE_NFE_CTE,
  (SELECT COUNT(*) FROM AD_DETSIMULARSIMP DET WHERE DET.CODSIMSIM = A.CODSIMSIM) AS CONTADOR
FROM AD_DETSIMULARSIMP A
WHERE CODSIMSIM = ?
ORDER BY CODDETSIMSIMP
